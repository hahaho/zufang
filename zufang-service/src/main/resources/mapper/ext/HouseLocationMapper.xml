<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.apass.zufang.mapper.zfang.HouseLocationMapper" >
   <select id="getLocationByHouseId" resultMap="BaseResultMap">
        SELECT 
            <include refid="Base_Column_List" />
        FROM t_zfang_house_location
        WHERE is_delete = '00' AND house_id= #{houseId}
   </select>
   <!-- init附近房源By经纬 -->
    <select id="initNearLocation" resultType="com.apass.zufang.domain.vo.HouseVo"
    	parameterType="java.util.Map">
    	<![CDATA[
			SELECT
				h.id			id,
				h.title			title,
				h.rent_amt		rentAmt,
				h.room			room,
				h.hall			hall,
				h.wei			wei,
				h.acreage		acreage,
				l.province		province,
				l.city			city,
				l.district		district,
				l.street		street,
				l.detail_addr	detailAddr,
				l.longitude longitude,
				l.latitude	latitude
			FROM
				t_zfang_house h,
				t_zfang_house_location l,
				t_zfang_apartment a,
				t_zufang_work_city_jd c
			WHERE
				h.id = l.house_id
				AND h.apartment_id = a.id
				AND h.is_delete = '00'
				AND h.type = '1'
				AND h.status = '3'
				AND l.province = c.PROVINCE
				AND c.CITY = #{city}
	      ORDER BY h.page_view DESC;
       	]]>
    </select>
   	<!-- init附近房源Bycity -->
    <select id="initHouseByCity" resultType="com.apass.zufang.domain.vo.HouseVo"
    	parameterType="java.util.Map">
    	<![CDATA[
			SELECT
				h.id			id,
				h.title			title,
				h.rent_amt		rentAmt,
				h.room			room,
				h.hall			hall,
				h.wei			wei,
				h.acreage		acreage,
				l.province		province,
				l.city			city,
				l.district		district,
				l.street		street,
				l.detail_addr	detailAddr,
				l.longitude longitude,
				l.latitude	latitude
			FROM
				t_zfang_house h,
				t_zfang_house_location l,
				t_zfang_apartment a
			WHERE
				h.id = l.house_id
				AND h.apartment_id = a.id
				AND h.is_delete = '00'
				AND h.type = #{type}
				AND h.status = '3'
				AND l.city = #{city}
	        	ORDER BY h.page_view DESC;
       	]]>
    </select>
</mapper>